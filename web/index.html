<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Jira AI Search</title>
    <link rel="stylesheet" href="/style.css?v=4" />
  </head>
  <body>
    <main class="layout">
      <div class="main-split">
        <section class="panel search-panel">
          <h1>Jira AI Search</h1>
          <div class="field">
            <label for="query">Natural query</label>
            <textarea id="query" placeholder="e.g. Найди мои задачи в статусе To Do"></textarea>
          </div>
          <div class="field">
            <label for="jql">JQL override (опционально)</label>
            <input id="jql" type="text" placeholder='project = CE AND status = "To Do"' />
          </div>
          <div class="field inline">
            <button id="preview" type="button">Preview JQL</button>
            <button id="run">Search</button>
          </div>
          <div class="field inline">
            <label><input type="checkbox" id="analysis" /> Analysis (LLM summary)</label>
            <label><input type="checkbox" id="showRaw" /> Show raw JSON</label>
          </div>
          <div class="filters">
            <div class="field">
              <label>Проекты (по умолчанию все)</label>
              <div id="projectsBox" class="checkboxes">
                <label><input type="checkbox" data-role="all" checked /> Все проекты</label>
              </div>
            </div>
            <div class="field">
              <label>Пользователи (по умолчанию все)</label>
              <div id="usersBox" class="checkboxes">
                <label><input type="checkbox" data-role="all" checked /> Все пользователи</label>
              </div>
            </div>
            <div class="field">
              <label>Спринт (последние 5)</label>
              <div id="sprintsBox" class="checkboxes"></div>
            </div>
          </div>
        </section>
        <section class="panel results-panel">
          <h2>Results</h2>
          <div id="stepsPanel" class="steps-panel"></div>
          <div class="status" id="status"></div>
          <pre id="output" class="output"></pre>
          <div class="command-panel">
            <label for="commandInput">Что сделать с текущими данными?</label>
            <textarea id="commandInput" rows="2" placeholder="Например: сделай список ссылок в виде HTML"></textarea>
            <div class="command-actions">
              <button id="commandRun" type="button">Выполнить</button>
            </div>
            <div id="commandOutput" class="command-output"></div>
          </div>
        </section>
      </div>
      <aside class="panel history">
        <section class="phrases">
          <h2>Стандартные фразы</h2>
          <div class="field">
            <label for="phraseInput">Новая/правка</label>
            <input id="phraseInput" type="text" placeholder="Например: выведи заведенные ошибки за этот месяц" />
            <label for="phraseDesc" style="margin-top: 8px;">Description (опционально)</label>
            <input id="phraseDesc" type="text" placeholder="Например: для отчёта по QA / авто-лог времени" />
            <div class="inline">
              <button id="phraseSave" type="button">Сохранить</button>
              <button id="phraseCancel" type="button">Сбросить выбор</button>
            </div>
          </div>
          <ul id="phrasesList" class="phrases-list"></ul>
        </section>
        <section class="history-section">
          <h2>История ответов</h2>
          <div id="historyList" class="history-list"></div>
          <div id="historyDetail" class="history-detail"></div>
        </section>
      </aside>
    </main>
    <script src="/app.js?v=4"></script>
  </body>
</html>

